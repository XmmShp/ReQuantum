<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:ReQuantum.ViewModels"
             xmlns:controls="https://github.com/avaloniaui/lib/controls"
             xmlns:models="clr-namespace:ReQuantum.Modules.Zdbk.Models"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="ReQuantum.Views.GradeView"
             x:DataType="viewModels:GradeViewModel">
    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
         to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <viewModels:GradeViewModel />
    </Design.DataContext>
 
  <StackPanel Spacing="12">

      <!-- 桌面端 -->
      <Grid IsVisible="{Binding WindowService.IsDesktopMode}" 
            ColumnDefinitions="*, *" 
            RowDefinitions=" 150, 500"> 
        
          <!-- 第一块（左上） -->
          <Panel Grid.Row="0" Grid.Column="0" Background="Transparent">
              <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="10">

                  <StackPanel Spacing="5">
                      <TextBlock Text="学年" FontSize="12" Foreground="Gray"/>
                      <ComboBox ItemsSource="{Binding AvailableYears}"
                                SelectedItem="{Binding SelectedYear}"
                                Width="140"/>
                  </StackPanel>

                  <StackPanel Spacing="5">
                      <TextBlock Text="学期" FontSize="12" Foreground="Gray"/>
                      <ComboBox ItemsSource="{Binding AvailableTerms}"
                                SelectedItem="{Binding SelectedTerm}"
                                Width="80"/>
                  </StackPanel>

              </StackPanel>
          </Panel>

          <!-- 第二块（右上） -->
          <Panel Grid.Row="0" Grid.Column="1">
              <StackPanel Orientation="Horizontal" Spacing="20" HorizontalAlignment="Center" VerticalAlignment="Center"
                          IsVisible="{Binding Grades, Converter={x:Static ObjectConverters.IsNotNull}}">

                  <StackPanel Spacing="10">
                      <Border Background="#F0F4FF" CornerRadius="8" Padding="15,10" Width="140">
                          <StackPanel>
                              <TextBlock Text="总学分 (累计)" FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>
                              <TextBlock Text="{Binding Grades.Credit}" FontSize="20" FontWeight="Bold" Foreground="#333" HorizontalAlignment="Center"/>
                          </StackPanel>
                      </Border>
                      <Border Background="#E3F2FD" CornerRadius="8" Padding="15,10" Width="140" BorderBrush="#BBDEFB" BorderThickness="1">
                          <StackPanel>
                              <TextBlock Text="本学期学分" FontSize="11" Foreground="#1976D2" HorizontalAlignment="Center"/>
                              <TextBlock Text="{Binding Grades.Credit}" FontSize="20" FontWeight="Bold" Foreground="#1976D2" HorizontalAlignment="Center"/>
                          </StackPanel>
                      </Border>
                  </StackPanel>

                  <StackPanel Spacing="10">
                      <Border Background="#FFF0F0" CornerRadius="8" Padding="15,10" Width="140">
                          <StackPanel>
                              <TextBlock Text="平均绩点 (累计)" FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>
                              <TextBlock Text="{Binding Grades.GradePoint5, StringFormat='{}{0:F2}'}" FontSize="20" FontWeight="Bold" Foreground="#D32F2F" HorizontalAlignment="Center"/>
                          </StackPanel>
                      </Border>
                      <Border Background="#FFEBEE" CornerRadius="8" Padding="15,10" Width="140" BorderBrush="#FFCDD2" BorderThickness="1">
                          <StackPanel>
                              <TextBlock Text="本学期绩点" FontSize="11" Foreground="#C62828" HorizontalAlignment="Center"/>
                              <TextBlock Text="{Binding Grades.GradePoint5, StringFormat='{}{0:F2}'}" FontSize="20" FontWeight="Bold" Foreground="#C62828" HorizontalAlignment="Center"/>
                          </StackPanel>
                      </Border>
                  </StackPanel>

                  <StackPanel Spacing="10">
                      <Border Background="#F0FFF4" CornerRadius="8" Padding="15,10" Width="140">
                          <StackPanel>
                              <TextBlock Text="主修绩点 (累计)" FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>
                              <TextBlock Text="{Binding Grades.MajorGradePoint, StringFormat='{}{0:F2}'}" FontSize="20" FontWeight="Bold" Foreground="#2E7D32" HorizontalAlignment="Center"/>
                          </StackPanel>
                      </Border>
                      <Border Background="#E8F5E9" CornerRadius="8" Padding="15,10" Width="140" BorderBrush="#C8E6C9" BorderThickness="1">
                          <StackPanel>
                              <TextBlock Text="本学期主修绩点" FontSize="11" Foreground="#2E7D32" HorizontalAlignment="Center"/>
                              <TextBlock Text="{Binding Grades.MajorGradePoint, StringFormat='{}{0:F2}'}" FontSize="20" FontWeight="Bold" Foreground="#1B5E20" HorizontalAlignment="Center"/>
                          </StackPanel>
                      </Border>
                  </StackPanel>

              </StackPanel>

              <TextBlock Text="暂无数据" Foreground="Gray"
                         HorizontalAlignment="Center" VerticalAlignment="Center"
                         IsVisible="{Binding Grades, Converter={x:Static ObjectConverters.IsNull}}"/>
          </Panel>
          
          <!-- 第三块（左下） -->
          <Border Grid.Row="1" Grid.Column="0">
              <ScrollViewer>
              <ItemsControl ItemsSource="{Binding Grades.CoursesGrade}">
                  <!-- 这就是模具 -->
                  <ItemsControl.ItemTemplate>
                      <DataTemplate x:DataType="models:ZdbkCoursesGrade">
                          <!-- 这里定义每一行的视觉结构 -->
                          <Border CornerRadius="16" Margin="5 5 20 5" Background="{DynamicResource CourseGradePanelBrush}"
                                  BoxShadow="5 5 10 0 #40000000">
                              <Grid ColumnDefinitions="Auto, Auto"
                                    RowDefinitions="Auto,Auto,Auto"
                                    Margin="10">
                                  <TextBlock Grid.Column="0" Text="{Binding CourseName}" FontWeight="Medium" />
                                  <TextBlock Grid.Column="1" Text="{Binding Grade100}" FontWeight="Bold" />
                                  <TextBlock Grid.Row="1"  Grid.Column="0" Text="{Binding  AcademicYear}" FontWeight="Thin" Foreground="{DynamicResource SmallTextBrush}" FontSize="10"/>
                                  <TextBlock Grid.Row="1"  Grid.Column="1" Text="{Binding  CourseCode}" FontWeight="Thin" Foreground="{DynamicResource SmallTextBrush}"  FontSize="10"/>
                                  <ProgressBar Grid.Row="2" 
                                               Height="6" 
                                               Margin="0,4"
                                               Minimum="0" 
                                               Maximum="100" 
                                               Value="{Binding Grade100}" 
                                               CornerRadius="3"
                                               Foreground="{DynamicResource ProgressBarBrush}"
                                               Background="#10000000"/>
                              </Grid>
                          </Border>
                      </DataTemplate>
                  </ItemsControl.ItemTemplate>
              </ItemsControl>
              </ScrollViewer>
          </Border>

          <!-- 第四块（右下） -->
          <Panel Grid.Row="1" Grid.Column="1">
              <TextBlock Text="可视化图表" HorizontalAlignment="Center" VerticalAlignment="Center"/>
          </Panel>

          <!-- 水平分割线：位于第0行底部，跨越2列 -->
          <Rectangle Grid.Row="0" Grid.ColumnSpan="2" 
                     Height="1" Fill="Gray" Opacity="0.3"
                     VerticalAlignment="Bottom"/>
        
          <!-- 垂直分割线：位于第0列右侧，跨越2行 -->
          <Rectangle Grid.Column="0" Grid.RowSpan="2" 
                     Width="1" Fill="Gray" Opacity="0.3"
                     HorizontalAlignment="Right"/>
      </Grid>

    <!-- 移动端 -->
    <Grid  IsVisible="{Binding !WindowService.IsDesktopMode}">

    </Grid>


  </StackPanel>
  <!-- Add Resources Here -->
</UserControl>
